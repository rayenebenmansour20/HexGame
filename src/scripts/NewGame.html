<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Hex</title>
    <link rel="stylesheet" href="button.css">
    <style>
        #canvas-container {
            position: relative;
            left: 400px;
            right: 200px;
            width: 850px;
            height: 600px;
        }
        #button-container {
            text-align: center;
            margin-top: 10px;
        }
        .dialog {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 5px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
            z-index: 1000;
            max-width: 80%;
            max-height: 80%;
            overflow-y: auto;
            display: flex; /* Utilisation de flexbox */
            flex-direction: column; /* Affichage vertical */
            align-items: center; /* Centrage horizontal */
        }

        #tree-graph {
            width: 100%;
            height: 100%; /* Utilisez la hauteur maximale disponible */
        }

        .close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            cursor: pointer;
        }
    </style>
</head>
<body onload="load()">
    <div id="canvas-container">
        <button class="button-29" id="acceuilbutton" onClick="returnHome()">Revenir à l'accueil</button>
        <canvas style="background-color: whitesmoke; border-radius: 10px;" width="840" height="600" id="output">Canvas not supported...</canvas>
        <div id="button-container">
            <input class="button-29" type="button" onClick="showTreeDialog()" value="Afficher l'arbre de recherche"><br>
            <input class="button-29" type="button" onClick="init()" value="Nouvelle Partie"><br>
            <br><div class="checkbox-wrapper-55">
                <label class="rocker rocker-small">
                    <input id="mp" type="checkbox" onClick="chgMP()">
                    <span class="switch-left">NON</span>
                    <span class="switch-right">IA</span>
                </label>
            </div>
            <br><input class="button-29" type="button" onClick="undo()" value="Annuler">
        </div>
    </div>
    <div id="tree-dialog" class="dialog" style="display: none;">
        <span class="close-btn" onclick="closeTreeDialog()">&times;</span>
        <div id="tree-graph"></div>
    </div>
   
    <!-- Scripts JavaScript -->
    <script src="./modules/Node.js"></script>
    <script src="./modules/HeuristicTree.js"></script>
    <script src="ia.js"></script>
    <script src="display.js"></script>    
    <script src="../../node_modules/react/umd/react.development.js"></script>
    <script src="../../node_modules/react-dom/umd/react-dom.development.js"></script>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script>
function returnHome() {
    window.location.href = "/"; // Rediriger vers la racine du site
}

function showTreeDialog() {
    console.log("La fonction showTreeDialog() est appelée.");

    // Sélection de la boîte de dialogue de l'arbre
    const treeDialog = document.getElementById('tree-dialog');
    treeDialog.style.display = 'block';

    // Sélection du conteneur de graphique d'arbre
    const treeGraphContainer = document.getElementById('tree-graph');

    // Création du nœud racine avec une valeur d'heuristique spécifique
    const rootNode = new Node();
    rootNode.setValue(0); // Valeur d'heuristique spécifique pour le nœud racine

    // Création des nœuds enfants avec des valeurs d'heuristique spécifiques
    const child1 = new Node();
    child1.setValue(10); // Valeur d'heuristique spécifique pour le premier enfant
    const child2 = new Node();
    child2.setValue(20); // Valeur d'heuristique spécifique pour le deuxième enfant

    // Ajout des enfants au nœud racine
    rootNode.addChild(child1);
    rootNode.addChild(child2);

    // Création des nœuds petits-enfants avec des valeurs d'heuristique spécifiques
    const grandchild1 = new Node();
    grandchild1.setValue(5); // Valeur d'heuristique spécifique pour le premier petit-enfant
    const grandchild2 = new Node();
    grandchild2.setValue(15); // Valeur d'heuristique spécifique pour le deuxième petit-enfant

    // Ajout des petits-enfants au premier enfant
    child1.addChild(grandchild1);
    child1.addChild(grandchild2);

    // Création de l'arbre heuristique avec le nœud racine
    const heuristicTree = new HeuristicTree(rootNode);

    // Dessin de l'arbre avec les valeurs d'heuristique
    drawTree(rootNode, treeGraphContainer);
}

// Fonction pour dessiner l'arbre
function drawTree(rootNode, container) {
    const margin = { top: 20, right: 90, bottom: 30, left: 90 };
    const svgWidth = "100%";
    const svgHeight = "100%";

    const svg = d3.select(container)
        .append("svg")
        .attr("width", svgWidth)
        .attr("height", svgHeight)
        .append("g")
        .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

    const treeLayout = d3.tree().size([container.offsetHeight - margin.top - margin.bottom, container.offsetWidth - margin.left - margin.right]);
    const root = d3.hierarchy(rootNode);
    treeLayout(root);

    svg.selectAll(".link")
        .data(root.links())
        .enter()
        .append("path")
        .attr("class", "link")
        .attr("d", d3.linkVertical()
            .x(d => d.x)
            .y(d => d.y));

    const nodes = svg.selectAll(".node")
        .data(root.descendants())
        .enter()
        .append("g")
        .attr("class", "node")
        .attr("transform", d => "translate(" + d.x + "," + d.y + ")");

    nodes.append("circle")
        .attr("r", 5);

    nodes.append("text")
        .attr("dy", 3)
        .attr("x", d => d.children ? -8 : 8)
        .style("text-anchor", d => d.children ? "end" : "start")
        .text(d => d.data.getValue()); // Affiche la valeur du nœud
}

// Fonction pour fermer le dialogue de l'arbre
function closeTreeDialog() {
    const treeDialog = document.getElementById('tree-dialog');
    treeDialog.style.display = 'none';
    const treeGraphContainer = document.getElementById('tree-graph');
    treeGraphContainer.innerHTML = ''; // Effacez le contenu pour fermer l'arbre
}

    </script>
</body>
</html>
